/*
 * jQuery Navgoco Menus Plugin v0.1.0 (2013-07-07)
 * https://github.com/tefra/navgoco
 *
 * Copyright (c) 2013 Chris T
 * BSD - https://github.com/tefra/navgoco/blob/master/LICENSE-BSD
 */
!function(a){"use strict";var b=function(b,c,d){return this.el=b,this.$el=a(b),this.options=c,this.uuid=this.$el.attr("id")?this.$el.attr("id"):d,this.open={},this.init(),this};b.prototype={init:function(){var b=this;b._load(),b.$el.find("ul").each(function(c){var d=a(this);d.attr("data-index",c),b.options.save&&b.open.hasOwnProperty(c)?(d.parent().addClass(b.options.openClass),d.show()):d.parent().hasClass(b.options.openClass)?(d.show(),this.open[c]=1):d.hide()});var c=b.$el.find("li:has(ul) > a");b.options.caret&&c.append(b.options.caret),c.click(function(c){c.preventDefault();var d=a(this).next(),e=d.is(":visible");b._toggle(d,!e),b._save()})},_toggle:function(b,c){var d=this,e=b.attr("data-index"),f=b.parent();if(c){if(f.addClass(d.options.openClass),b.slideDown(d.options.slide),d.open[e]=1,d.options.accordion){var g=f.parents("ul"),h={};h[e]=1,g.each(function(){var b=a(this).attr("data-index");h[b]=1,d.open[b]=1}),d.$el.find("ul:visible").each(function(){var b=a(this),c=b.attr("data-index");h.hasOwnProperty(c)||d._toggle(b,!1)})}}else f.removeClass(d.options.openClass),b.slideUp(d.options.slide),this.open[e]=0},toggle:function(b){for(var c=this,d=Array.prototype.slice.call(arguments,1),e={},f=0;f<d.length;f++)e[d[f]]=!0;c.$el.find("ul").each(function(){var d=a(this),f=d.attr("data-index");return e.length&&!e.hasOwnProperty(f)||(c._toggle(d,b),1!==e.length)?void 0:!1}),c._save()},_save:function(){if(this.options.save){var b={};for(var d in this.open)1===this.open[d]&&(b[d]=1);c[this.uuid]=b,a.cookie(this.options.cookie.name,JSON.stringify(c),this.options.cookie)}},_load:function(){if(this.options.save){if(null===c){var b=a.cookie(this.options.cookie.name);c=b?JSON.parse(b):{}}this.open=c.hasOwnProperty(this.uuid)?c[this.uuid]:{}}}};var c=null,d={caret:'<span class="caret"></span>',accordion:!1,openClass:"open",save:!0,cookie:{name:"navgoco",expires:!1,path:"/"},slide:{duration:400,easing:"swing"}};a.fn.navgoco=function(c){var e="string"==typeof c&&"_"!==c.charAt(0);if(e)var f=Array.prototype.slice.call(arguments,1);else c=a.extend({},d,c||{}),a.cookie||(c.save=!1);return this.each(function(d){var g=a(this),h=g.data("navgoco");e&&h?h[c].apply(h,f):h||e||g.data("navgoco",new b(this,c,d))})}}(jQuery);